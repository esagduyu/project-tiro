{% extends "base.html" %}

{% block title %}Tiro â€” Inbox{% endblock %}

{% block content %}
<nav class="view-tabs">
    <button class="view-tab active" data-view="articles">All Articles</button>
    <button class="view-tab" data-view="digest">Daily Digest</button>
</nav>

<!-- Articles view -->
<section id="view-articles" class="inbox">
    <div class="search-bar">
        <input type="text" id="search-input" placeholder="Search your library..." autocomplete="off">
        <button id="search-clear" class="search-clear" style="display: none;">&times;</button>
    </div>
    <div id="empty-state" class="empty-state" style="display: none;">
        <h2>No articles yet</h2>
        <p>Save your first article to get started:</p>
        <code>curl -X POST http://localhost:8000/api/ingest/url \
  -H "Content-Type: application/json" \
  -d '{"url": "https://example.com/article"}'</code>
    </div>
    <div id="inbox-toolbar" class="inbox-toolbar" style="display: none;">
        <button id="classify-btn" class="classify-btn">Classify inbox</button>
        <button id="discard-toggle" class="discard-toggle" style="display: none;">Show discarded (0)</button>
        <button id="archived-toggle" class="discard-toggle" style="display: none;">Show archived</button>
        <span id="classify-info" class="classify-info"></span>
        <select id="sort-select" class="sort-select">
            <option value="newest">Newest first</option>
            <option value="oldest">Oldest first</option>
            <option value="importance">By importance</option>
        </select>
    </div>
    <div id="article-list" class="article-list"></div>
</section>

<!-- Digest view -->
<section id="view-digest" class="digest-view" style="display: none;">
    <div class="digest-tabs">
        <button class="digest-tab active" data-type="ranked">Ranked</button>
        <button class="digest-tab" data-type="by_topic">By Topic</button>
        <button class="digest-tab" data-type="by_entity">By Entity</button>
        <button class="digest-refresh" id="digest-refresh" title="Regenerate digest">&#8635;</button>
    </div>
    <div id="digest-loading" class="digest-loading" style="display: none;">
        <div class="digest-spinner"></div>
        <p>Opus 4.6 is analyzing your articles...</p>
        <p class="digest-loading-sub">Finding connections, contradictions, and insights</p>
    </div>
    <div id="digest-error" class="digest-error" style="display: none;">
        <p id="digest-error-msg">Failed to generate digest.</p>
        <button onclick="loadDigest(true)">Try again</button>
    </div>
    <div id="digest-banner" class="digest-banner" style="display: none;"></div>
    <div id="digest-content" class="digest-content">
        <div id="digest-ranked" class="digest-section reader-body"></div>
        <div id="digest-by-topic" class="digest-section reader-body" style="display: none;"></div>
        <div id="digest-by-entity" class="digest-section reader-body" style="display: none;"></div>
    </div>
    <div id="digest-empty" class="empty-state" style="display: none;">
        <h2>No digest yet</h2>
        <p>Save some articles first, then come back for your daily digest.</p>
    </div>
</section>
{% endblock %}
