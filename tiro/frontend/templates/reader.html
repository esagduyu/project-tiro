{% extends "base.html" %}

{% block title %}Tiro â€” Reading{% endblock %}

{% block content %}
<article id="reader" class="reader" data-article-id="{{ article_id }}">
    <div id="reader-loading" class="reader-loading">Loading article...</div>
    <div id="reader-error" class="reader-error" style="display: none;">
        <p>Could not load this article.</p>
        <a href="/">&larr; Back to inbox</a>
    </div>
    <div id="reader-content" style="display: none;">
        <nav class="reader-nav">
            <a href="/" class="back-link">&larr; Back to inbox</a>
            <div class="reader-actions">
                <button id="analysis-btn" class="analysis-btn" title="Ingenuity Analysis">&#9432;</button>
                <button class="rate-btn love" data-rating="2" title="Love">&hearts;</button>
                <button class="rate-btn like" data-rating="1" title="Like">&plus;</button>
                <button class="rate-btn dislike" data-rating="-1" title="Dislike">&minus;</button>
            </div>
        </nav>
        <header class="reader-header">
            <h1 id="reader-title"></h1>
            <div class="reader-meta">
                <span id="reader-source" class="source-name"></span>
                <span id="reader-vip" class="vip-star" style="display: none;">&#9733;</span>
                <span class="meta-sep">&middot;</span>
                <span id="reader-author"></span>
                <span class="meta-sep" id="author-sep">&middot;</span>
                <span id="reader-date"></span>
                <span class="meta-sep">&middot;</span>
                <span id="reader-time"></span>
            </div>
            <div class="reader-source-link">
                <a id="reader-original-link" href="" target="_blank" rel="noopener noreferrer"></a>
            </div>
            <div id="reader-tags" class="article-tags"></div>
        </header>
        <div id="reader-summary" class="reader-summary"></div>
        <div id="reader-body" class="reader-body"></div>
        <section id="related-articles" class="related-articles" style="display: none;">
            <h3 class="related-header">Related in your library</h3>
            <div id="related-list" class="related-list"></div>
        </section>
    </div>
</article>
<!-- Analysis side panel -->
<div id="analysis-panel" class="analysis-panel">
    <div class="analysis-panel-header">
        <h3>Ingenuity Analysis</h3>
        <button id="analysis-close" class="analysis-close">&times;</button>
    </div>
    <div id="analysis-intro" class="analysis-intro">
        <p class="analysis-intro-text">
            Ingenuity Analysis uses Claude Opus 4.6 to evaluate this article across three dimensions:
        </p>
        <div class="analysis-pillars">
            <div class="analysis-pillar">
                <strong>Bias</strong>
                <span>Detects ideological lean, rhetorical framing, and missing perspectives</span>
            </div>
            <div class="analysis-pillar">
                <strong>Factual Confidence</strong>
                <span>Evaluates sourcing quality, unsupported claims, and red flags</span>
            </div>
            <div class="analysis-pillar">
                <strong>Novelty</strong>
                <span>Assesses originality of ideas and unique contribution to discourse</span>
            </div>
        </div>
        <button id="analysis-run-btn" class="analysis-run-btn">Run Ingenuity Analysis with Opus 4.6</button>
    </div>
    <div id="analysis-loading" class="analysis-loading" style="display: none;">
        <div class="digest-spinner"></div>
        <p>Analyzing with Opus 4.6...</p>
        <p class="digest-loading-sub">This may take up to a minute</p>
    </div>
    <div id="analysis-error" class="analysis-error" style="display: none;">
        <p>Analysis failed.</p>
        <button id="analysis-retry">Retry</button>
    </div>
    <div id="analysis-body" style="display: none;"></div>
</div>
<div id="analysis-overlay" class="analysis-overlay"></div>
<script src="/static/reader.js?v=24"></script>
{% endblock %}
